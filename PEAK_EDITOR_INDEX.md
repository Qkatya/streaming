# Peak Editor Application - File Index

## ðŸ“ Complete File List

### ðŸŽ¯ Core Application Files

| File | Purpose | Lines | Key Features |
|------|---------|-------|--------------|
| **peak_editor_app.py** | Main Dash application | ~500 | PeakEditor class, interactive UI, peak management |
| **launch_peak_editor.py** | Data loader for real data | ~150 | Integrates with existing pipeline, loads from split DF |
| **test_peak_editor.py** | Testing with synthetic data | ~150 | Generates test signals, safe testing environment |
| **analyze_modifications.py** | Analysis and visualization | ~250 | Statistics, plots, CSV export |
| **example_use_edited_peaks.py** | Usage examples | ~300 | Metrics calculation, comparison tools |

### ðŸ“š Documentation Files

| File | Purpose | Content |
|------|---------|---------|
| **PEAK_EDITOR_README.md** | Comprehensive documentation | Full feature descriptions, usage, troubleshooting |
| **QUICK_START.md** | Quick reference guide | Installation, quick examples, tips |
| **PEAK_EDITOR_SUMMARY.md** | Complete overview | Architecture, workflow, integration |
| **PEAK_EDITOR_INDEX.md** | This file | File listing and navigation |

### ðŸ“¦ Configuration Files

| File | Purpose |
|------|---------|
| **requirements_dash.txt** | Python dependencies |

## ðŸš€ Quick Navigation

### For First-Time Users
1. Start here: **QUICK_START.md**
2. Test the app: `python test_peak_editor.py`
3. Read full docs: **PEAK_EDITOR_README.md**

### For Running the App
1. Install: `pip install -r requirements_dash.txt`
2. Launch: `python launch_peak_editor.py [row_index]`
3. Edit peaks in browser at http://127.0.0.1:8050

### For Analysis
1. Run: `python analyze_modifications.py`
2. Use peaks: See **example_use_edited_peaks.py**
3. Integration: See **PEAK_EDITOR_SUMMARY.md**

## ðŸ“Š Output Files (Generated by App)

| File | Type | Content |
|------|------|---------|
| **removed_peaks.pkl** | Pickle (set) | Frame indices of removed peaks |
| **added_peaks.pkl** | Pickle (set) | Frame indices of added peaks |
| **final_gt_peaks.pkl** | Pickle (array) | Final GT peaks after editing |
| **peak_modifications.csv** | CSV | Exported peak data (optional) |
| **peak_modifications_analysis.png** | Image | Timeline visualization (optional) |
| **peak_intervals_histogram.png** | Image | Interval distribution (optional) |

## ðŸ”§ File Dependencies

```
peak_editor_app.py
â”œâ”€â”€ Imports: blink_analyzer.py
â”œâ”€â”€ Imports: visualization.py
â””â”€â”€ Creates: removed_peaks.pkl, added_peaks.pkl, final_gt_peaks.pkl

launch_peak_editor.py
â”œâ”€â”€ Imports: blinking_split_analysis.py
â”œâ”€â”€ Imports: blink_analyzer.py
â”œâ”€â”€ Imports: peak_editor_app.py
â””â”€â”€ Uses: split dataframe, GT blendshapes, predictions

test_peak_editor.py
â”œâ”€â”€ Imports: peak_editor_app.py
â””â”€â”€ Generates: synthetic data

analyze_modifications.py
â”œâ”€â”€ Reads: removed_peaks.pkl, added_peaks.pkl, final_gt_peaks.pkl
â””â”€â”€ Creates: plots and CSV files

example_use_edited_peaks.py
â”œâ”€â”€ Reads: final_gt_peaks.pkl
â””â”€â”€ Demonstrates: usage patterns
```

## ðŸ“ File Sizes (Approximate)

| File | Size | Complexity |
|------|------|------------|
| peak_editor_app.py | ~15 KB | Medium |
| launch_peak_editor.py | ~5 KB | Low |
| test_peak_editor.py | ~5 KB | Low |
| analyze_modifications.py | ~10 KB | Medium |
| example_use_edited_peaks.py | ~10 KB | Medium |
| PEAK_EDITOR_README.md | ~15 KB | - |
| QUICK_START.md | ~3 KB | - |
| PEAK_EDITOR_SUMMARY.md | ~15 KB | - |

## ðŸŽ“ Learning Path

### Beginner
1. Read **QUICK_START.md**
2. Run `python test_peak_editor.py`
3. Practice editing synthetic data
4. Read **PEAK_EDITOR_README.md** sections as needed

### Intermediate
1. Run `python launch_peak_editor.py [row_index]`
2. Edit real data
3. Run `python analyze_modifications.py`
4. Review **PEAK_EDITOR_SUMMARY.md** for integration

### Advanced
1. Study **peak_editor_app.py** source code
2. Customize thresholds and parameters
3. Use **example_use_edited_peaks.py** patterns
4. Integrate with existing analysis pipeline

## ðŸ” Key Classes and Functions

### peak_editor_app.py
- `PeakEditor` class: Main peak management
  - `__init__()`: Initialize with signals
  - `toggle_peak()`: Add/remove peaks
  - `get_current_gt_peaks()`: Get edited peaks
  - `save_modifications()`: Save to files
  - `get_window_data()`: Get window data
- `create_app()`: Create Dash application
- `create_window_figure()`: Create visualization

### launch_peak_editor.py
- `load_data_for_editor()`: Load GT and predictions
- `extract_blinks()`: Extract blink signals
- `main()`: Entry point

### analyze_modifications.py
- `load_modification_files()`: Load pickles
- `print_statistics()`: Show stats
- `plot_modifications_timeline()`: Visualize timeline
- `plot_modification_histogram()`: Show intervals
- `export_to_csv()`: Export data

### example_use_edited_peaks.py
- `load_edited_peaks()`: Load final peaks
- `calculate_metrics_with_edited_peaks()`: Compute metrics
- `compare_original_vs_edited()`: Before/after comparison

## ðŸŽ¨ UI Components

### Main Application (peak_editor_app.py)
- **Title**: "Ground Truth Peak Editor"
- **Info Panel**: Statistics display
- **Navigation Buttons**: Previous/Next window
- **Window Display**: Current window indicator
- **Save Button**: Save modifications
- **Main Graph**: Interactive z-score plot
- **Status Message**: Save confirmation

### Graph Elements
- **Blue line**: GT z-score
- **Red line**: Prediction z-score
- **Green circles**: Matched GT peaks
- **Orange circles**: Unmatched GT peaks
- **Green X's**: Matched pred peaks
- **Red X's**: Unmatched pred peaks

## ðŸ”— External Dependencies

### Required Packages
- dash >= 2.14.0
- plotly >= 5.17.0
- pandas >= 1.5.0
- numpy >= 1.23.0
- scipy >= 1.10.0

### Existing Project Files
- blink_analyzer.py
- visualization.py
- blinking_split_analysis.py
- blendshapes_data_utils.py

## ðŸ’¡ Usage Patterns

### Pattern 1: Quick Edit
```bash
python launch_peak_editor.py 3663
# Edit in browser
# Click Save
```

### Pattern 2: Test First
```bash
python test_peak_editor.py
# Practice editing
python launch_peak_editor.py 3663
# Edit real data
```

### Pattern 3: Full Workflow
```bash
python launch_peak_editor.py 3663
# Edit and save
python analyze_modifications.py
# Review changes
python example_use_edited_peaks.py
# See usage examples
```

## ðŸ“ˆ Typical File Sizes (Output)

| File | Typical Size | Notes |
|------|--------------|-------|
| removed_peaks.pkl | < 1 KB | Set of integers |
| added_peaks.pkl | < 1 KB | Set of integers |
| final_gt_peaks.pkl | 1-5 KB | Numpy array |
| peak_modifications.csv | 5-20 KB | Text format |
| *.png plots | 50-200 KB | High-res images |

## ðŸŽ¯ Common Tasks

| Task | Command/File |
|------|--------------|
| Install dependencies | `pip install -r requirements_dash.txt` |
| Test interface | `python test_peak_editor.py` |
| Edit peaks | `python launch_peak_editor.py [row_idx]` |
| Analyze edits | `python analyze_modifications.py` |
| See examples | `python example_use_edited_peaks.py` |
| Read docs | Open **PEAK_EDITOR_README.md** |
| Quick reference | Open **QUICK_START.md** |

## ðŸ—ï¸ Architecture Overview

```
User Interface (Dash)
        â†“
PeakEditor Class
        â†“
Peak Detection (scipy)
        â†“
Visualization (plotly)
        â†“
Data Storage (pickle)
```

## âœ… Checklist for New Users

- [ ] Read QUICK_START.md
- [ ] Install dependencies
- [ ] Run test_peak_editor.py
- [ ] Practice editing synthetic data
- [ ] Read PEAK_EDITOR_README.md
- [ ] Run launch_peak_editor.py with real data
- [ ] Edit and save peaks
- [ ] Run analyze_modifications.py
- [ ] Review example_use_edited_peaks.py
- [ ] Integrate with your analysis

## ðŸ“ž Getting Help

1. **Quick questions**: Check **QUICK_START.md**
2. **Detailed info**: Check **PEAK_EDITOR_README.md**
3. **Integration**: Check **PEAK_EDITOR_SUMMARY.md**
4. **Usage examples**: Check **example_use_edited_peaks.py**
5. **Code reference**: Check source files with docstrings

## ðŸŽ‰ You're Ready!

All files are created and documented. Start with:
```bash
python test_peak_editor.py
```

Happy peak editing! ðŸš€


